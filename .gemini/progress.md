# MafiaUniversity 프로젝트 진행 상황

## 📅 마지막 작업: 2026-02-02

---

## ✅ 완료된 작업

### 1단계: 게임 핵심 로직 (마피아 역할 배정 + 투표 시스템)
- ✅ **역할 배정**: 마피아, 시민, 경찰, 의사 역할 자동 배정
- ✅ **마피아 킬 기능**: 근처 플레이어를 킬할 수 있는 버튼
- ✅ **긴급 회의 소집**: 🚨 버튼으로 회의 소집
- ✅ **시체 발견 & 리포트**: 시체 근처에서 리포트 버튼
- ✅ **투표 시스템**: 회의 후 투표로 플레이어 추방
- ✅ **경찰 조사**: 플레이어가 마피아인지 확인
- ✅ **의사 보호**: 마피아 공격으로부터 보호
- ✅ **승리 조건 판정**: 마피아 전멸 → 시민 승리, 마피아가 과반 → 마피아 승리

### 2단계: 대학교 캠퍼스 맵
- ✅ **맵 크기**: 2000x1500
- ✅ **건물들**: 본관, 도서관, 학생회관, 체육관, 강의동 A/B, 연구동, 기숙사
- ✅ **도로와 중앙선**
- ✅ **장식물**: 나무, 벤치, 분수대
- ✅ **건물 충돌 처리**

### 3단계: 멀티플레이어 동기화 개선
- ✅ **네트워크 보간 (Interpolation)** 시스템 추가
- ✅ **위치 예측 (Extrapolation)**
- ✅ **부드러운 다른 플레이어 이동**

### 4단계: UI/UX 개선
- ✅ **프리미엄 홈 페이지 디자인** (우주 테마)
- ✅ **글래스모피즘 효과**
- ✅ **그라데이션 & 마이크로 인터랙션**
- ✅ **반응형 디자인**
- ✅ **Google Fonts (Inter, Orbitron)**

---

## 🔧 마지막 수정 사항 (재시작 시 확인 필요!)

### CORS 문제 수정됨
**문제**: 프론트엔드가 5174 포트에서 실행되는데 백엔드 CORS가 5173만 허용함
**해결**: `.env` 파일에서 `FRONTEND_URL=http://localhost:5174`로 변경 완료

### 서버 재시작 필요!
다음 명령어 실행:
```bash
# 터미널 1: 백엔드 서버
cd c:\Users\sungw\Desktop\MafiaUniversity\mafia-server
npm run dev

# 터미널 2: 프론트엔드 서버
cd c:\Users\sungw\Desktop\MafiaUniversity\frontend
npm run dev
```

---

## 📁 주요 파일 구조

```
MafiaUniversity/
├── frontend/                    # React + Vite 프론트엔드
│   ├── src/
│   │   ├── App.tsx              # 라우터 설정
│   │   ├── App.css              # 홈페이지 스타일 (프리미엄 디자인)
│   │   ├── index.css            # 전역 스타일
│   │   ├── pages/
│   │   │   ├── Home.tsx         # 로그인 페이지
│   │   │   ├── Lobby.tsx        # 대기실/방 목록
│   │   │   ├── Lobby.css        # 대기실 스타일
│   │   │   └── Game.tsx         # 게임 컨테이너
│   │   └── game/
│   │       ├── GameScene.ts     # Phaser 게임 씬 (마피아 로직 포함)
│   │       ├── types.ts         # 타입 정의
│   │       └── NetworkInterpolation.ts  # 네트워크 보간
│   └── .env.development         # 개발 환경 변수
│
├── mafia-server/                # Node.js + Socket.IO 백엔드
│   ├── src/
│   │   ├── index.ts             # 서버 메인 (Socket.IO 이벤트)
│   │   ├── roomManager.ts       # 방 관리
│   │   └── gameLogic.ts         # 마피아 게임 로직
│   └── .env                     # 환경 변수 (CORS 설정 포함)
│
└── backend/                     # 기존 Python 백엔드 (사용 안함)
```

---

## 🎮 테스트 방법

1. 서버 2개 실행 (위 명령어 참고)
2. 브라우저 탭 2개에서 `http://localhost:5174` 접속
3. 각각 다른 닉네임/대학교 입력 후 입장
4. 한 명이 방 생성 → 다른 한 명 참가
5. 준비 → 게임 시작
6. 역할에 따라 플레이!

---

## 🚧 다음에 할 일 (옵션)

- [ ] 밤/낮 시스템 추가 (원한다면)
- [ ] 미션 포인트 추가 (원한다면)
- [ ] 채팅 시스템
- [ ] 사운드 효과
- [ ] 더 상세한 게임 UI (역할 안내 팝업 등)
- [ ] 배포 (Vercel/Render)

---

## 📌 참고: 최소 플레이어 수

현재 테스트를 위해 **2명**으로 설정됨.
실제 게임에서는 `mafia-server/src/roomManager.ts`에서 4명으로 변경 권장.

```typescript
// 162번째 줄
if (room.players.length < 2) {  // 4로 변경 권장
```
